(()=>{"use strict";function e(e,t){let o=0;return{length:e,hits:o,direction:t,typeOfShip:()=>5===e?"carrier":4===e?"battleship":3===e?"cruiser":3===e?"submarine":2===e?"patrol boat":void 0,getHits:()=>o,increaseHit:()=>{o++},isSunk:()=>o>=e}}function t(){let e=[],t=[],o=[],l=[];const r=()=>e,n=()=>o;return{placeShip:(o,l,r)=>!!((e,o,l)=>{let r=[],n=!1;for(let t=0;t<e.length;t++)"horizontal"===e.direction?r.push([o+t,l]):r.push([o,l+t]);return r.forEach((e=>{t.some(((t,o)=>t[0]===e[0]&&t[1]===e[1]))&&(n=!0)})),console.log(n),!1===n&&("horizontal"===e.direction?o+e.length-1<10:l+e.length-1<10)})(o,l,r)&&(((o,l,r)=>{if("horizontal"===o.direction)for(let n=0;n<o.length;n++)e.push([o,l+n,r]),t.push([l+n,r]);else for(let n=0;n<o.length;n++)e.push([o,l,r+n]),t.push([l,r+n])})(o,l,r),!0),receiveAttack:(e,i)=>{let[...a]=r();return null!=a.find(((t,o)=>t[1]===e&&t[2]===i))?(void 0===l.find(((t,o)=>t[0]===e&&t[1]===i))&&l.push([e,i]),!0):n().find(((t,o)=>t[0]===e&&t[1]===i))?void 0:(o.push([e,i]),t.push([e,i]),!1)},missed:o,areAllSunk:()=>e.length===l.length,occupiedCoords:e,cells:t,getCells:()=>t,getOccupiedCells:r,getHit:()=>l,getMissed:n}}document.querySelector(".grids");const o=document.querySelector(".player-grid"),l=document.querySelector(".AI-grid");let r=function(){let e=0,t="player";return{turnCount:e,currentTurn:t,getTurn:()=>t,changeTurn:t=>{e=t},playerTurn:(o,l,r)=>{let n=o.receiveAttack(l,r);if(console.log(`x is ${l} y is ${r}`),console.log(`v is ${n}`),n||(t="AI",e++),n)return!0},AITurn:(o,l,r)=>{let n,i;return void 0===l&&void 0===r?(i=[Math.floor(10*Math.random()),Math.floor(10*Math.random())],console.log(i),n=o.receiveAttack(i[0],i[1])):(i=[l,r],console.log(i),n=o.receiveAttack(l,r)),console.log(`v is ${n}`),void 0===n?[i,"AlreadyPlayed"]:void 0!==n&&!0!==n?(t="player",e++,[i,"missed"]):[i,"hit"]},getRandomAdjacent:(e,t,o)=>{console.log(`from getRandom x is ${e} and y is ${t}`);let l=[[e+1,t],[e-1,t],[e,t+1],[e,t-1]].filter((e=>e[0]>=0&&e[0]<=9&&e[1]>=0&&e[1]<=9)),r=o.getMissed(),n=o.getHit(),i=r.concat(n),a=l.filter((e=>function(e){let t=!0;for(let o=0;o<i.length;o++)i[o][0]===e[0]&&i[o][1]===e[1]&&(t=!1);return t}(e)));var c;return console.log("not already played options are: "),console.log(a),[(c=a,console.log(`the items are : ${c}`),c[Math.floor(Math.random()*c.length)],c[Math.floor(Math.random()*c.length)])]}}}(),n=t(),i=t(),a=e(4,"horizontal"),c=e(3,"vertical"),s=e(3,"horizontal"),d=e(2,"vertical");function h(e){if(console.log("no player"),"player"===r.getTurn()){let t=e.id.split(",");if(r.playerTurn(i,Number(t[0]),Number(t[1]))){let[...o]=i.getHit();[...o].forEach((o=>{o[0]===Number(t[0])&&o[1]===Number(t[1])&&e.classList.add("hitted-cell")}))}else u()}}function u(e){let t;if(console.log(`e is ${e}`),"AI"===r.getTurn())if(t=void 0===e?r.AITurn(n):r.AITurn(n,e[0],e[1]),"AlreadyPlayed"===t[1])[...o.childNodes].forEach((e=>{let o=e.id.split(",");t[0][0]===Number(o[0])&&t[0][1]===Number(o[1])&&(console.log("yellow"),setTimeout((()=>{e.style.backgroundColor="yellow"}),0))})),u();else if("missed"===t[1])[...o.childNodes].forEach((e=>{let o=e.id.split(",");t[0][0]===Number(o[0])&&t[0][1]===Number(o[1])&&(console.log("pink"),setTimeout((()=>{e.style.backgroundColor="pink"}),0))}));else if("hit"===t[1]){let[e]=r.getRandomAdjacent(t[0][0],t[0][1],n);[...o.childNodes].forEach((e=>{let o=e.id.split(",");Number(o[0])===t[0][0]&&Number(o[1])===t[0][1]&&setTimeout((()=>{e.classList.add("hitted-cell")}),0)})),console.log(`GET RANDOM IS ${e}`),u(e)}}n.placeShip(a,1,0),n.placeShip(c,3,5),n.placeShip(s,4,8),n.placeShip(d,7,6),function(){for(let e=9;e>=0;e--){document.createElement("div");for(let t=0;t<10;t++){let l=document.createElement("div");o.appendChild(l).className="player-grid-item",l.innerText=`${t},${e}`,l.id=`${t},${e}`}}for(let e=9;e>=0;e--){document.createElement("div");for(let t=0;t<10;t++){let o=document.createElement("div");l.appendChild(o).className="AI-grid-item",o.innerText=`${t},${e}`,o.id=`${t},${e}`}}}(),function(){let t=["horizontal","vertical"],o=e(4,t[Math.floor(Math.random()*t.length)]),l=e(3,t[Math.floor(Math.random()*t.length)]),r=e(3,t[Math.floor(Math.random()*t.length)]),n=e(2,t[Math.floor(Math.random()*t.length)]);for(console.log(o),console.log(l),console.log(r),console.log(n);!i.placeShip(o,Math.floor(10*Math.random()),Math.floor(10*Math.random())););for(;!i.placeShip(l,Math.floor(10*Math.random()),Math.floor(10*Math.random())););for(;!i.placeShip(r,Math.floor(10*Math.random()),Math.floor(10*Math.random())););for(;!i.placeShip(n,Math.floor(10*Math.random()),Math.floor(10*Math.random())););}(),function(){const e=window.document.querySelectorAll(".player-grid-item");let t=n.getCells();console.log("it is "+i.getOccupiedCells()),e.forEach(((e,o)=>{t.some((t=>t.toString()===e.id))&&e.classList.add("has-ship")}));const o=window.document.querySelectorAll(".AI-grid-item");let l=i.getCells();l.forEach((e=>{})),o.forEach(((e,t)=>{l.some((t=>t.toString()===e.id))&&e.classList.add("has-ship")}))}(),[...l.childNodes].forEach(((e,t)=>{e.addEventListener("click",(function(){h(e)}))}))})();